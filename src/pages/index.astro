---
import type { ComponentProps } from "astro/types";
import Anchor from "@/components/atoms/anchor.astro";
import Entry from "@/components/atoms/entry.astro";
import Separator from "@/components/atoms/separator.astro";
import Template from "@/components/layouts/template.astro";
import { getCollectionWithDates } from "@/helpers/time";

const journals = await getCollectionWithDates("journals");
const projects = await getCollectionWithDates("projects");

const description = "Pk experimental garden.";

const metadata: ComponentProps<typeof Template>["meta"] = {
  title: "The Index",
  description,
};

const structuredData: ComponentProps<typeof Template>["structuredData"] = {
  description,
};
---

<Template meta={metadata} structuredData={structuredData}>
  <h1>The Index</h1>

  <p>
    Software, simplicity, and the build-it-yourself mindset. A minimal
    laboratory for technical notes and experiments.
  </p>

  <br>

  <section aria-labelledby="journals">
    <h2>journals</h2>
    <ul class="list-none p-0 space-y-2">
      {journals.splice(0,3).map((journal) => (
      <li>
        <Entry 
          id={journal.id} 
          collection={journal.collection} 
          title={journal.data.title} 
          description={journal.data.description}
          date={journal.data.created}
        />
      </li>
      ))}
    </ul>
    <Anchor href="/journal">view all</Anchor>
  </section>

  <section aria-labelledby="projects">
    <h2>projects</h2>
    <ul class="list-none p-0 space-y-2">
      {projects.splice(0,3).map((project) => (
      <li>
        <Entry 
          id={project.id} 
          collection={project.collection} 
          title={project.data.title} 
          description={project.data.description}
        />
      </li>
      ))}
    </ul>
    <Anchor href="/projects">view all</Anchor>
  </section>

  <br>

  <Separator />

  <section aria-labelledby="site info">
    <div><small>[SITE_INFO]</small></div>
    <div><small>owner: pk - frontend engineer</small></div>
    <div><small>js: minimal (umami analytics only)</small></div>
    <div><small>license: CC BY-NC-SA 4.0</small></div>
    <div><small>version: 3.1.0</small></div>
    <div><small>build: {Astro.generator.toLowerCase()}</small></div>
  </section>
</Template>
